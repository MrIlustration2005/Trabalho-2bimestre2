name: Agendamento Noturno

on:
  schedule:
    # Executa automaticamente das 19h Ã s 23h (horÃ¡rio de BrasÃ­lia â†’ 22hâ€“02h UTC)
    - cron: '0 22-23 * * *'
    # Executa automaticamente da meia-noite Ã s 5h (horÃ¡rio de BrasÃ­lia â†’ 03hâ€“08h UTC)
    - cron: '0 3-8 * * *'
  workflow_dispatch: # Permite rodar manualmente

jobs:
  exemplo-noite:
    runs-on: ubuntu-latest

    steps:
      - name: Verificar horÃ¡rio (somente 19hâ€“5h de BrasÃ­lia)
        id: verificar
        run: |
          HORA_BR=$(TZ='America/Sao_Paulo' date +%H)
          echo "ğŸ• Hora atual no Brasil: $HORA_BR"
          
          # Verifica se estÃ¡ entre 19h e 5h
          if [ $HORA_BR -ge 19 ] || [ $HORA_BR -lt 6 ]; then
            echo "âœ… Dentro do horÃ¡rio permitido (19hâ€“5h no Brasil)."
            echo "executar=true" >> $GITHUB_OUTPUT
          else
            echo "âš ï¸ Aviso: fora do horÃ¡rio permitido (19hâ€“5h no Brasil)."
            echo "executar=false" >> $GITHUB_OUTPUT
          fi

      - name: Executar aÃ§Ã£o noturna
        if: steps.verificar.outputs.executar == 'true'
        run: |
          echo "ğŸŒ™ Executando aÃ§Ã£o noturna..."
          echo "ğŸ• HorÃ¡rio atual (BrasÃ­lia): $(TZ='America/Sao_Paulo' date)"
          echo "ğŸ•’ HorÃ¡rio UTC: $(date -u)"

      - name: Ignorar execuÃ§Ã£o (fora do horÃ¡rio)
        if: steps.verificar.outputs.executar == 'false'
        run: echo "â¸ï¸ ExecuÃ§Ã£o ignorada, pois nÃ£o Ã© horÃ¡rio noturno."
